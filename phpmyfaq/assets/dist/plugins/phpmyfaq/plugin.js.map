{"version":3,"file":"/../../../phpmyfaq/assets/dist/plugins/phpmyfaq/plugin.js","mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,0EAA0E;AACtF,YAAY,sEAAsE;AAClF;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb,WAAW;AACX;AACA;AACA;AACA;AACA,iEAAiE,SAAS,YAAY;AACtF,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,0FAA0F,WAAW,IAAI,gBAAgB;AACzH,mBAAmB;AACnB;AACA,gBAAgB;AAChB;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,6DAA6D,IAAI,IAAI,MAAM;;AAE3E;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,CAAC","sources":["webpack://@thorsten/phpmyfaq/../../../../phpmyfaq/admin/assets/src/tinymce/phpmyfaq.tinymce.plugin.js"],"sourcesContent":["/**\n * TinyMCE v6 plugin to fetch and insert internal links via Ajax call\n *\n * This Source Code Form is subject to the terms of the Mozilla Public License,\n * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n * obtain one at https://mozilla.org/MPL/2.0/.\n *\n * @package   phpMyFAQ\n * @author    Thorsten Rinne <thorsten@phpmyfaq.de>\n * @copyright 2015-2023 phpMyFAQ Team\n * @license   http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0\n * @link      https://www.phpmyfaq.de\n * @since     2015-10-08\n */\n\ntinymce.PluginManager.add('phpmyfaq', function (editor, url) {\n  'use strict';\n\n  const openDialog = function (csrfToken) {\n    return editor.windowManager.open({\n      title: 'phpMyFAQ TinyMCE Plugin',\n      body: {\n        type: 'panel',\n        items: [\n          { type: 'input', name: 'search', label: 'Search', id: 'pmf-internal-links' },\n          { type: 'htmlpanel', html: '<div id=\"pmf-faq-list\" class=\"p-1\"></div>' },\n        ],\n      },\n      buttons: [\n        {\n          type: 'cancel',\n          text: 'Close',\n        },\n        {\n          type: 'submit',\n          text: 'Save',\n          primary: true,\n        },\n      ],\n      onChange: (api) => {\n        const data = api.getData();\n        const url = location.protocol + '//' + location.host + location.pathname;\n        const list = document.getElementById('pmf-faq-list');\n\n        if (data.search.length > 0) {\n          fetch(url + 'api/faq/search', {\n            method: 'POST',\n            headers: {\n              Accept: 'application/json, text/plain, */*',\n              'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n              search: data.search,\n              csrf: csrfToken,\n            }),\n          })\n            .then(async (response) => {\n              if (response.ok) {\n                return response.json();\n              }\n              throw new Error('Network response was not ok: ', { cause: { response } });\n            })\n            .then((response) => {\n              if (response.success) {\n                list.innerHTML = '';\n                const searchResults = response.success;\n                if (searchResults.length > 0) {\n                  searchResults.forEach((result) => {\n                    list.innerHTML += `<label> <input type=\"radio\" name=\"faqURL\" value=\"${result.url}\">${result.question}</label><br>`;\n                  });\n                }\n              } else {\n                console.error(response.error);\n              }\n            })\n            .catch(async (error) => {\n              const errorMessage = await error.cause.response.json();\n              console.error(errorMessage);\n            });\n        }\n      },\n      onSubmit: (api) => {\n        const selected = document.querySelector('input[name=faqURL]:checked');\n        const url = selected.value;\n        const title = selected.parentNode.textContent;\n        const anchor = `<a class=\"pmf-internal-link\" href=\"${url}\">${title}</a>`;\n\n        editor.insertContent(anchor);\n        api.close();\n      },\n    });\n  };\n\n  // Add button to editor\n  editor.ui.registry.addButton('phpmyfaq', {\n    text: 'phpMyFAQ',\n    //image: 'images/phpmyfaq.gif',\n    onAction: () => {\n      const csrfToken = document.getElementById('pmf-csrf-token').value;\n      openDialog(csrfToken);\n    },\n  });\n\n  return {\n    getMetadata: function () {\n      return {\n        name: 'phpMyFAQ TinyMCE plugin',\n        url: 'https://www.phpmyfaq.de/documentation',\n      };\n    },\n  };\n});\n"],"names":[],"sourceRoot":""}